<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardster - Spelregels</title>
    <!-- Copy ALL styles from index.html -->
    <style>
        /* --- STYLES ARE UNCHANGED, OMITTED FOR BREVITY --- */
         @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap');

        :root {
            --primary: #ff6600; /* Orange */
            --secondary: #00ccff; /* Cyan */
            --bg-dark: #0a0a0a;
            --bg-light: #1a1a1a;
            --text: #ffffff;
            --success: #33cc33; /* Green */
            --danger: #ff3355; /* Red */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* Changed from center to start to allow footer at bottom naturally */
            min-height: 100vh;
            background-color: var(--bg-dark);
            color: var(--text);
            background-image:
                radial-gradient(circle at 20% 30%, rgba(255, 102, 0, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(0, 204, 255, 0.1) 0%, transparent 40%);
            padding-top: 80px; /* Increased padding to avoid overlap with fixed menu */
            padding-bottom: 20px; /* Reduced bottom padding slightly */
        }

        /* --- Collapsible Menu Styles (Copied from index.html - UNCHANGED) --- */
        /* ... (menu styles omitted for brevity) ... */
        #menu-toggle-btn {
            position: fixed; /* Fixed positioning */
            top: 15px;
            right: 15px;
            z-index: 1001; /* Ensure it's above the menu */
            background: rgba(26, 26, 26, 0.8); /* Dark background */
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            width: 45px;
            height: 40px;
            cursor: pointer;
            padding: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            /* Reset button styles */
            margin: 0;
            text-transform: none;
            letter-spacing: normal;
            overflow: visible; /* Ensure spans are visible */
            transition: background 0.3s ease;
        }

        #menu-toggle-btn:hover {
            background: rgba(40, 40, 40, 0.9);
        }

        #menu-toggle-btn span {
            display: block;
            width: 100%;
            height: 3px;
            background-color: var(--secondary); /* Cyan lines */
            border-radius: 1px;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        /* Animation for hamburger to X */
        #menu-toggle-btn[aria-expanded="true"] span:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }
        #menu-toggle-btn[aria-expanded="true"] span:nth-child(2) {
            opacity: 0;
        }
        #menu-toggle-btn[aria-expanded="true"] span:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }


        #collapsible-menu {
            position: fixed; /* Fixed positioning */
            top: 65px; /* Position below the button */
            right: 15px;
            z-index: 1000; /* Below toggle button, above content */
            background-color: rgba(20, 20, 20, 0.95); /* Slightly different dark */
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            width: 220px; /* Adjust as needed */
            overflow: hidden; /* Clip content */
            transition: transform 0.3s ease, opacity 0.3s ease, visibility 0s linear 0.3s; /* Delay visibility change */
            transform-origin: top right;
            transform: scale(0.95); /* Start slightly scaled down */
            opacity: 0;
            visibility: hidden; /* Use visibility for better transition and accessibility */
        }

        #collapsible-menu:not(.hidden) {
            transform: scale(1);
            opacity: 1;
            visibility: visible;
            transition: transform 0.3s ease, opacity 0.3s ease, visibility 0s linear 0s; /* Remove delay when showing */
        }


        #collapsible-menu ul {
            list-style: none;
            padding: 10px 0;
            margin: 0;
        }

        #collapsible-menu li {
            margin: 0;
        }

        #collapsible-menu li a,
        #collapsible-menu li button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            color: var(--text);
            text-decoration: none;
            font-size: 15px;
            border: none;
            background: none;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
            font-family: 'Roboto', sans-serif; /* Ensure font consistency */
        }

        #collapsible-menu li a:hover,
        #collapsible-menu li button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--primary); /* Highlight with orange on hover */
        }

        /* Style menu buttons like links */
        #collapsible-menu li button {
            /* Override default button styles if needed */
            border-radius: 0;
            margin: 0;
            box-shadow: none;
            text-transform: none;
            letter-spacing: normal;
            font-weight: normal; /* Match link weight */
        }
        /* --- End Menu Styles --- */


        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 600px; /* Slightly wider for text content */
            padding: 20px;
            flex-grow: 1; /* Allow container to grow and push footer down */
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 32px;
            margin-bottom: 20px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

         /* Style for the rules page title */
         h2 {
            font-family: 'Orbitron', sans-serif;
            color: var(--secondary);
            text-align: center;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Standard Box Styling (Copied from index.html - UNCHANGED) */
        .box {
            text-align: left; /* Align text left for rules */
            background-color: rgba(26, 26, 26, 0.85);
            padding: 25px; /* More padding for text */
            border-radius: 10px;
            margin: 20px 0;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            line-height: 1.6; /* Better readability for paragraphs */
        }

        .box h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            margin-top: 20px;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 102, 0, 0.3);
            padding-bottom: 5px;
        }
         .box h3:first-child {
             margin-top: 0;
         }

        .box p {
            margin-bottom: 15px;
            font-weight: 300;
        }

        .box ul {
            list-style: disc;
            margin-left: 25px;
            margin-bottom: 15px;
        }
         .box li {
             margin-bottom: 8px;
             font-weight: 300;
         }
        .box .nested-list {
            list-style: circle; /* Different style for nested list */
            margin-top: 8px;
            margin-left: 20px; /* Indent further */
        }
        .box .nested-list li {
            margin-bottom: 5px; /* Smaller spacing */
            font-weight: normal; /* Normal weight for sub-items */
        }

        .box strong {
             font-weight: bold;
             color: var(--secondary); /* Highlight key terms */
         }
         .box .highlight-orange {
             font-weight: bold;
             color: var(--primary);
         }

         /* Footer Styles */
         footer {
             width: 100%;
             text-align: center;
             margin-top: 40px; /* Space above footer */
             padding: 15px 0;
             font-size: 0.85em; /* Smaller text */
             color: rgba(255, 255, 255, 0.6); /* Faded white */
             border-top: 1px solid rgba(255, 255, 255, 0.1); /* Subtle separator line */
         }

         /* Utility */
        .hidden { display: none !important; }

        /* Loading Spinner for Spelregels (optional, for token validation) */
        .loading-spinner { display: inline-block; width: 16px; height: 16px; margin-left: 8px; border: 2px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: var(--secondary); animation: spin 1s ease-in-out infinite; vertical-align: middle;}
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
    <!-- Favicon links (Copied from index.html - UNCHANGED) -->
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="manifest" href="./site.webmanifest">
</head>
<body>

    <!-- START Menu (Copied from index.html - UNCHANGED) -->
    <button id="menu-toggle-btn" aria-label="Toggle Menu" aria-expanded="false" aria-controls="collapsible-menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <nav id="collapsible-menu" class="collapsible-menu hidden">
        <ul>
	        <li><a href="index.html" target="_self">Hardster Original</a></li> <!-- Changed target -->
            <li><a href="qr_scanner.html" target="_blank">QR Code Scanner</a></li>
            <li><a href="spelregels.html" target="_self">Spelregels</a></li> <!-- Link to self -->
            <li id="menu-login-item" class="hidden"><button id="menu-login-btn">Login met Spotify</button></li>
            <li id="menu-logout-item" class="hidden"><button id="menu-logout-btn">Logout</button></li>
        </ul>
    </nav>
    <!-- END Menu -->

    <div class="container">
        <h1>HARDSTER</h1>
        <h2>Spelregels</h2>

        <div class="box">
            <h3>Doel van het Spel</h3>
            <p>Raad zo snel mogelijk de <strong>artiest, titel, en het releasejaar</strong> van het nummer dat wordt afgespeeld. Snelheid is essentieel! De eerste speler die <strong class="highlight-orange">40 punten</strong> bereikt, wint het spel!</p>

            <h3>Voorbereiding</h3>
            <ol style="list-style: decimal; margin-left: 25px; margin-bottom: 15px;">
                <li style="margin-bottom: 8px;">De spelleider verbindt de website met zijn/haar <strong>Spotify (Premium)</strong> account via de knop in het menu.</li>
                <li style="margin-bottom: 8px;">Kies een <strong>actief Spotify afspeelapparaat</strong> (bijv. speaker, laptop, telefoon) waarop de muziek moet spelen.</li>
                <li style="margin-bottom: 8px;">Voeg <strong>alle spelers</strong> toe met hun namen (en eventueel een foto).</li>
                <li style="margin-bottom: 8px;">Plak de <strong>URL of ID</strong> van een Spotify playlist in het invoerveld.</li>
                <li style="margin-bottom: 8px;">Druk op <strong class="highlight-orange">"Start Spel"</strong>.</li>
            </ol>

            <h3>Spelverloop & Puntentelling</h3>
            <p>De muziek begint te spelen (een willekeurig nummer uit de gekozen playlist).</p>
            <ul>
                <li>Spelers roepen zo snel mogelijk wat ze denken dat de <strong>artiest</strong>, de <strong>titel</strong>, en/of het <strong>releasejaar</strong> is.</li>
                <li>Zodra iemand (of de groep) denkt het te weten, of als de spelleider vindt dat er genoeg tijd is verstreken, klikt de spelleider op <strong class="highlight-orange">"Bekijk Nummer"</strong>.</li>
                <li>De muziek pauzeert (of gaat zachtjes door) en de <strong>details van het nummer</strong> (hoes, artiest, titel, releasejaar) worden getoond.</li>
                <li>De <strong>scorelijst</strong> verschijnt.</li>
                <li>De spelleider kent punten toe aan de spelers op basis van wat ze correct hebben geroepen (v√≥√≥r het onthullen):
                    <ul class="nested-list">
                        <li><strong>1 punt</strong> voor de juiste <strong>Artiest</strong>.</li>
                        <li><strong>1 punt</strong> voor de juiste <strong>Titel</strong>.</li>
                        <li><strong>1 punt</strong> voor het juiste <strong>Releasejaar</strong>.</li>
                        <li>Een speler kan dus maximaal <strong>3 punten</strong> per nummer verdienen voor deze onderdelen.</li>
                    </ul>
                </li>
                <li><strong>Bonus Snelheidspunt (+1 punt):</strong>
                    <ul class="nested-list">
                         <li>Als een speler binnen <strong>ongeveer 5 seconden</strong> na het starten van het nummer *alle drie* de onderdelen (Artiest, Titel, √©n Releasejaar) correct weet te noemen, verdient die speler <strong>1 extra bonuspunt</strong>.</li>
                         <li>Een speler kan dus maximaal 4 punten in een ronde verdienen (3 basis + 1 bonus).</li>
                         <li>De spelleider beoordeelt of aan de snelheidseis is voldaan.</li>
                    </ul>
                </li>
                 <li>De spelleider gebruikt de <strong>'+'</strong> en <strong>'-'</strong> knoppen bij elke speler om de score aan te passen volgens de behaalde punten in deze ronde.</li>
                 <li>Nadat de punten zijn verdeeld, klikt de spelleider op <strong class="highlight-orange">"Volgende Nummer"</strong> om door te gaan.</li>
            </ul>

            <h3>Speciale Regel: Shotjes! üçª</h3>
            <ul>
                <li>Als na het onthullen van het nummer blijkt dat de <strong>titel</strong> een "drank-gerelateerd" woord bevat (zoals bier, shotje, wodka, drink, drunk, etc.), wordt er een <strong>willekeurige speler</strong> gekozen die een shotje moet nemen!</li>
                <li>De naam van de ongelukkige wordt bovenaan het scherm getoond (met üçª).</li>
            </ul>


            <h3>Einde van het Spel</h3>
            <ul>
                <li>Het spel eindigt zodra een speler <strong class="highlight-orange">40 punten of meer</strong> behaalt.</li>
                <li>De winnaar wordt bekendgemaakt (inclusief eventuele foto).</li>
                <li>De winnaar mag, afhankelijk van het aantal spelers, <strong>shotjes uitdelen</strong> aan andere spelers:
                    <ul>
                        <li>Bij 2-4 spelers: <strong>1 shotje</strong> uitdelen.</li>
                        <li>Bij 5+ spelers: <strong>2 shotjes</strong> uitdelen.</li>
                    </ul>
                </li>
                 <li>Een speciaal overwinningsnummer wordt (mogelijk) afgespeeld via Spotify.</li>
                 <li>Klik op <strong class="highlight-orange">"Nieuw Spel"</strong> om de scores te resetten en opnieuw te beginnen met dezelfde spelers en playlist, of gebruik het menu om het spel volledig te stoppen ("Quit Game").</li>
            </ul>
        </div>
    </div> <!-- End of .container -->

    <!-- Footer START -->
    <footer>
        <p>¬© <span id="copyright-year">2024</span> Hardster Project. Alle rechten voorbehouden.</p>
    </footer>
    <!-- Footer END -->

    <!-- Minimal JavaScript for Menu functionality -->
    <script>
        // Constants (Only those needed for auth/menu)
        const CLIENT_ID = '412e65076c5b43bdb49fd5ed6a734e17'; // Same as index.html
        // IMPORTANT: Redirect back to index.html for the main game logic after login
        const REDIRECT_URI = window.location.origin + window.location.pathname.replace('spelregels.html', 'index.html');
        const TOKEN_STORAGE_KEY = 'spotifyAccessToken'; // Key for localStorage

        // DOM elements (Only for menu)
        const el = {
            menuToggleBtn: document.getElementById('menu-toggle-btn'),
            collapsibleMenu: document.getElementById('collapsible-menu'),
            menuLoginItem: document.getElementById('menu-login-item'),
            menuLogoutItem: document.getElementById('menu-logout-item'),
            menuLoginBtn: document.getElementById('menu-login-btn'),
            menuLogoutBtn: document.getElementById('menu-logout-btn'),
        };

        // State (Only for auth status)
        let accessToken = null; // Holds the token if validated

        // --- Helper Functions (UNCHANGED) ---
        function toggleVisibility(element, show) {
            if (!element) return;
            element.classList.toggle('hidden', !show);
        }

        // Basic API call function JUST for validation on this page (UNCHANGED)
        async function simpleSpotifyApiCall(endpoint) {
             if (!accessToken) return { ok: false }; // No token to validate
             const headers = { 'Authorization': `Bearer ${accessToken}` };
             try {
                 const response = await fetch(`https://api.spotify.com/v1${endpoint}`, { headers });
                 if (response.status === 401) {
                     console.warn("Token validation failed (401)");
                     return { ok: false, status: 401 };
                 }
                 return { ok: true, status: response.status };
             } catch (error) {
                 console.error("Error validating token:", error);
                 return { ok: false, error: error };
             }
         }

        // --- Authentication and Menu Functions (UNCHANGED) ---
         async function checkAuth() {
             let authenticated = false;
             el.menuLoginBtn.innerHTML = 'Login... <span class="loading-spinner"></span>';
             toggleVisibility(el.menuLoginItem, true);
             toggleVisibility(el.menuLogoutItem, false);

             try {
                 const tokenFromStorage = localStorage.getItem(TOKEN_STORAGE_KEY);
                 if (tokenFromStorage) {
                     console.log("Token found in localStorage, validating...");
                     accessToken = tokenFromStorage;
                     const validationResult = await simpleSpotifyApiCall('/me');
                     if (validationResult.ok) {
                         console.log("Stored token is valid.");
                         authenticated = true;
                     } else {
                         console.log("Stored token invalid/expired.");
                         accessToken = null;
                         localStorage.removeItem(TOKEN_STORAGE_KEY);
                     }
                 } else {
                     console.log("No token found in localStorage.");
                     accessToken = null;
                 }
             } catch (e) {
                 console.error("Error during auth check:", e);
                 accessToken = null;
                 localStorage.removeItem(TOKEN_STORAGE_KEY);
             } finally {
                 updateMenuButtons(authenticated);
             }
             return authenticated;
         }

        function login() {
             const scopes = 'user-read-private user-read-email streaming user-modify-playback-state user-read-playback-state';
             const authUrl = 'https://accounts.spotify.com/authorize' +
                 '?response_type=token' +
                 '&client_id=' + encodeURIComponent(CLIENT_ID) +
                 '&scope=' + encodeURIComponent(scopes) +
                 '&redirect_uri=' + encodeURIComponent(REDIRECT_URI) +
                 '&show_dialog=true';
             window.location.href = authUrl;
        }

        function logout() {
            accessToken = null;
            localStorage.removeItem(TOKEN_STORAGE_KEY);
            console.log("User logged out (visual state updated).");
            updateMenuButtons(false);
        }

         function updateMenuButtons(isLoggedIn) {
            el.menuLoginBtn.textContent = 'Login met Spotify';
             const spinner = el.menuLoginBtn.querySelector('.loading-spinner');
             if (spinner) spinner.remove();
            toggleVisibility(el.menuLoginItem, !isLoggedIn);
            toggleVisibility(el.menuLogoutItem, isLoggedIn);
        }

        // --- Menu Toggle (UNCHANGED) ---
        function toggleMenu() {
            if (!el.menuToggleBtn || !el.collapsibleMenu) return;
            const isExpanded = el.menuToggleBtn.getAttribute('aria-expanded') === 'true';
            el.menuToggleBtn.setAttribute('aria-expanded', !isExpanded);
            el.collapsibleMenu.classList.toggle('hidden');
        }

        // Close menu if clicking outside (UNCHANGED)
        document.addEventListener('click', function(event) {
            if (!el.collapsibleMenu || !el.menuToggleBtn) return;
            const isClickInsideMenu = el.collapsibleMenu.contains(event.target);
            const isClickOnToggle = el.menuToggleBtn.contains(event.target);
            const isMenuOpen = !el.collapsibleMenu.classList.contains('hidden');

            if (!isClickInsideMenu && !isClickOnToggle && isMenuOpen) {
                toggleMenu();
            }
        });

        // --- Initialization ---
        function attachListeners() {
            el.menuToggleBtn?.addEventListener('click', toggleMenu);
            el.menuLoginBtn?.addEventListener('click', () => {
                login();
                 if (el.collapsibleMenu && !el.collapsibleMenu.classList.contains('hidden')) toggleMenu();
            });
            el.menuLogoutBtn?.addEventListener('click', () => {
                logout();
                 if (el.collapsibleMenu && !el.collapsibleMenu.classList.contains('hidden')) toggleMenu();
            });
            console.log("Spelregels page listeners attached.");
        }

        window.addEventListener('load', async () => {
             console.log("Spelregels page loaded.");
             attachListeners();
             await checkAuth(); // Check auth status

             // Update copyright year
             const yearSpan = document.getElementById('copyright-year');
             if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
             }
        });

    </script>
</body>
</html>
